<!DOCTYPE html>
<html>
<head>
    <title>Weather App</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="images/favicon.png" type="image/png" size="16x16">
    <meta name="keywords" content="Lusaka Province | Weather Forecast | Weather App |    ">
    <meta name="Author" content="Rodgers Chuba">
    <meta name="Description" content="Weather Application Forecast For Lusaka Province" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="./css/fontawesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="./css/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="./css/style.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script type="text/javascript" src="./js/jquery.js"></script>
    <style>
        .footer-wraper 
        {
            text-transform: uppercase;
            color: black;
        }
        #banner
        {
            width: 100%;
            background-image: url('./images/bg/a.jpg');
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
            object-fit: cover;
            background-attachment: fixed;
        }
        #banner .banner-fader 
        {
            height: 80vh;
            background: rgb(0, 0, 0);
            opacity: 0.845437;       
        }
        .highlights-cover
        {
            width: 100%;
            background-color: rgb(22, 32, 41);
        }
        .highlights-cover .highlight-card
        {
            width: 100%;
            background-color: rgb(27, 60, 88);
        }
        .highlight-fader
        {
            padding-top: 5%;
            padding-bottom: 15%;
            color: rgb(0, 0, 0);
            margin: 0;
        }
        .nav-menu-slide
        {
            width: 100%;
            background-image: url('./images/4.jpg');
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <main>
        <header class="banner" id="banner">
            <div class="banner-fader">
                <div class="main-nav-bg">
                    <div class="container">
                        <nav class="main-nav">
                            <div class="icon-logos">
                                <a href="index.html" class="logo">
                                    <img src="./images/logo.png" alt="logo"/>
                                </a>
                            </div>
                            <div class="nav-menu">
                                <ul>
                                    <li class="nav-item"><a href="index.html?#trending-news">Meteorological OrganizationS</a></li>
                                    <li class="nav-item"><a href="index.html?#current-city">Your Location</a></li>
                                    <li class="nav-item"><a href="index.html?#five-days-forecast">Five Day Weather</a></li>
                                    <li class="nav-item"><a href="index.html?#weather-conditions">Favourites</a></li>
                                    <li class="mob-nav-menu"><a><i class="fa fa-bars"></i></a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
                <div class="container shadow first-slate">
                    <div class="row">
                        <div class="banner-text-wrap">
                            <div class="banner-text">
                                <h2 class="banner-text-title" style="color:black;">LUSAKA PROVINCE WEATHER APP</h2>
                                <p class="banner-text-desc">
                                    The Weather application uses real - time satelites to provide weather updates 
                                    about any location in your province. 
                                    Find weather conditions; humidity, wind speed, wind direction, temperature and much
                                    by using our application.
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="row search-results">
                        <div class="search-canvas"> 
                            <form action="" method="get">
                                <input type="text" 
                                        name="search" 
                                        id="search" 
                                        class="form-control"
                                        placeholder="City/Town Name..." />

                                        <div class="err-display" id="err-display"></div>

                                <div class="search-btns-group">  
                                    <button type="button"  
                                            id="search-btn" 
                                            class="form-control btn btn-dark btn-sm weather-button">
                                            Search <i class="fa fa-search"></i>
                                    </button>
                                    <button type="button" 
                                            id="fav-city" 
                                            class="form-control btn btn-dark btn-sm weather-button">
                                            Save City  <i class="fa fa-cloud"></i>
                                    </button>
                                    <button type="button" 
                                            id="conver-units-btn" 
                                            class="form-control btn btn-dark btn-sm weather-button">
                                            Convert to Fahrenheit  <i class="fa fa-book"></i>
                                    </button>
                                </div>  
                                <span class="city-indicator-wrap"></span>
                            </form>
                        </div>
                        <div class="searched-canvas">
                            <div class="result">
                                <i class="fa fa-snowflake"></i>
                                <span id="windy-level" class="condition-level">0</span>
                                <strong>Wind</strong>
                            </div>
                            <div class="result">
                                <i class="fa fa-sun"></i>
                                <span id="temp-level" class="condition-level">0</span>
                                <strong>Temp</strong>
                            </div>
                            <div class="result">
                                <i class="fa fa-cloud"></i>
                                <span id="cloudy-level" class="condition-level">0</span>
                                <strong>Cloudy</strong>
                            </div>
                            <div class="result">
                                <i class="fa fa-cloud-rain"></i>
                                <span id="pressure-level" class="condition-level">0</span>
                                <strong>Pressure</strong>
                            </div>
                            <div class="result">
                                <i class="fa fa-cloud-sun"></i>
                                <span id="humidity-level" class="condition-level">0</span>
                                <strong>Humidity</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <section class="about-wrap" id="services-site">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 about-desc">
                        <div class="lead about-dsc-text">
                            <h2 style="text-align: center;min-width: 100%; color: black;"><strong>What Can Our App Do?</strong></h2>
                        </div>
                    </div>
                </div>
                <div class="row site-boxes-wrapper">
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4">
                        <div class="site-box shadow">
                            <i class="fa fa-water"></i>
                            <h4 class="site-box-title">Show Current City Weather Information</h4>
                            <p class="sit-box-desc">
                                This application provides information about the
                                current weather in your locality, city, town 
                                and district.
                            </p>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4">
                        <div class="site-box shadow">
                            <i class="fa fa-water"></i>
                            <h4 class="site-box-title">Show Five Days Weather Forecast</h4>
                            <p class="sit-box-desc">
                                This application provides information about the
                                current weather in your locality, city, town 
                                and district for five days ahead of time.
                            </p>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4">
                        <div class="site-box shadow">
                            <i class="fa fa-water"></i>
                            <h4 class="site-box-title">Show Favourite Towns</h4>
                            <p class="  ">
                                This application provides information about the
                                current weather in your locality, city, town 
                                and district and allows you to save weather data.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="highlights highlights-cover" id="current-city">
            <div class="highlight-fader">
                <div class="container">
                    <div class="hl-text-title">
                        <h3 class="hl-title">CONDITIONS IN YOUR CURRENT LOCALITY</h3>
                    </div>
                </div>
                <div class="container">
                    <div class="hightlights-wrap row-sp-evn">
                        <div class="highlight-card shadow">
                            <h1 id="current-city-temp-level" class="condition-level current-city-level">0</h1>
                            <p class="highlight-card-desc">
                                <strong><h4>Temperature<br> Prediction</h4></strong>
                            </p>
                        </div>
                        <div class="highlight-card shadow">
                            <h1 id="current-city-humidity-level" class="condition-level current-city-level">0</h1>
                            <p class="highlight-card-desc">
                                <strong><h4>Humidity <br> Prediction</h4></strong>
                            </p>
                        </div>
                        <div class="highlight-card shadow">
                            <h1 id="current-city-cloudy-level" class="condition-level current-city-level">0</h1>
                            <p class="highlight-card-desc">
                                <strong><h4>Cloudy <br> Prediction</h4></strong>
                            </p>
                        </div>
                        <div class="highlight-card shadow">
                            <h1 id="current-city-windy-level" class="condition-level current-city-level">0</h1>
                            <p class="highlight-card-desc">
                                <strong><h4>Wind <br> Prediction</h4></strong>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="services sect-pd" id="five-days-forecast">
            <div class="container">
                <div class="vss-text-title">
                    <h3 class="vss-title" style="color:black;">FIVE DAYS - PREDICTED WEATHER FORECAST</h3>
                    <p class="vss-title-desc">
                        The five days weather update is made as soon as the API gives back response
                    </p>
                </div>

            </div>
            <div class="container">
                <div class="row justify-content-center site-boxes-wrapper" id="five-day-focus-wrapper">
                </div>
            </div>
        </section>
        <section class="about-wrap news-wrapper" id="trending-news">
            <div class="container">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 about-desc">
                        <div class="lead about-dsc-text text-center" style="width: 100%;">
                            <h1><strong style="color:black;">Meteorological Organizations</strong></h1>
                        </div>
                    </div>
                </div>
                <div class="row site-boxes-wrapper">
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4">
                        <div class="site-box shadow">
                            <i class="fa fa-paper"></i>
                            <h4 class="site-box-title">World Meteorological Organization (WMO)</h4>
                            <p class="sit-box-desc">
                                The WMO is a specialized agency of the United Nations responsible for 
                                promoting international cooperation in meteorology, climatology, hydrology, 
                                and related fields. While it does not conduct weather forecasting itself, 
                                it coordinates the efforts of national meteorological services.
                            </p>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4">
                        <div class="site-box shadow">
                            <i class="fa fa-paper"></i>
                            <h4 class="site-box-title">Japan Meteorological Agency (JMA) </h4>
                            <p class="sit-box-desc">
                                The JMA is Japan's national meteorological organization. It provides 
                                weather forecasts, tsunami warnings, earthquake predictions, and other environmental data.
                            </p>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4">
                        <div class="site-box shadow">
                            <i class="fa fa-paper"></i>
                            <h4 class="site-box-title">Météo-France</h4>
                            <p class="  ">
                                France's national meteorological organization, which also serves as the regional center for the 
                                World Meteorological Organization's South-West Pacific and Indian Ocean regions.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
       
        <footer class="footer-wraper">
            <div class="footer-fader">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 text-center">
                            <div class="footer-contact" style="margin-bottom:20%;">
                                <h6>OUR SERVICES</h6>
                                <ul class="list-group">
                                    <li><a href="index.html">Home</a></li>
                                    <li class="nav-item"><a href="index.html?#trending-news">Meteorological OrganizationS</a></li>
                                    <li class="nav-item"><a href="index.html?#current-city">Your Location</a></li>
                                    <li class="nav-item"><a href="index.html?#five-days-forecast">Five Day Weather</a></li>
                                    <li class="nav-item"><a href="index.html?#weather-conditions">Favourites</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 text-center">
                            <div class="footer-contact" style="margin-bottom:20%; text-align: center;">
                                <h6>WORLD NEWS</h6>
                                <ul class="list-group">
                                    <li class="nav-item-2"><a href="index.html?#marketeers">BBC Weather</a></li>
                                    <li class="nav-item-2"><a href="index.html?#marketeers"></a>CNN Weather</li>
                                    <li class="nav-item-2"><a href="index.html?#marketeers">Aljazera Weather</a></li>
                                    <li class="nav-item-2"><a href="index.html?#marketeers">Global Weather</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 text-center">
                            <div class="footer-contact" style="margin-bottom:20%;">
                                <h6>CONFIDENTIALITY</h6>
                                <ul class="list-group">
                                    <li><a href="">Privacy Policy</a></li>
                                    <li><a href="">Opt-in And Opt-out</a></li>
                                    <li><a href="">Pricing</a></li>
                                    <li class="nav-item"><a href="https://www.icuzambia.net">ICU Zambia</a></li>
                                    <li class="nav-item"><a href="https://www.zrdc.org">ZRDC</a></li>
                                </ul>
                            </div>
                        </div>
                    </div> 
                    <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                            <div class="signature text-center">
                                &copy;2024.All Rights Reserved.Rodgers Chuba, SIN: 2309646222, BSc. Software Engineering</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <div class="nav-menu-slide">
        <div class="nm-slide-title row-sp-btn">
            <h4><strong>MENU</strong></h4>
            <span class="exit-slide-menu">x</span>
        </div>
        <ul>
            <li class="nav-item-2"><a href="index.html">Home</a></li>
            <li class="nav-item"><a href="index.html?#trending-news">Meteorological OrganizationS</a></li>
            <li class="nav-item"><a href="index.html?#current-city">Your Location</a></li>
            <li class="nav-item"><a href="index.html?#five-days-forecast">Five Day Weather</a></li>
            <li class="nav-item"><a href="index.html?#weather-conditions">Favourites</a></li>
        </ul>
    </div>
    <script src="./js/menu.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script>
        /****
         * 
         * @Save user current city latitude, longitude and city name
         * 
         * */
        let coords = {
            "lat":"",
            "lng":"",
            "city":""
        };

        /****
         * 
         * @Automated AJAX request to fetch current city data 
         * @and update records in the JS object data structure 
         * @above, using Gelocation Database API
         * 
         * */
        $.ajax({
            type: "GET",
            url: "https://geolocation-db.com/json/",
            async: true,
            success: function(data){
                let location = JSON.parse(data);
                coords.lat = location.latitude;
                coords.lng = location.longitude;
                coords.city = location.city;
                setTimeout(() => {
                    currentCityWeather();
                    fiveDayWeatherForecast(coords);
                }, 5000);
            },                     
            error: function(err){
                $("#err-display").html("<div class='err-notice-bad'>Network failure detected, to fetch weather information, refresh your browser.</div>");      
            } 
        });  

        /****
         * 
         * @OPEN WEATHER MAP API IN USE BELOW
         * @Fetching current user city weather information
         * @Obtains city; latitude, longitude and city name from Object updated by Geolocation API
         * 
         * */
        function currentCityWeather(){
            const lat = coords.lat;
            const lng = coords.lng;
            const current_city = coords.city;
            if(lat!="" && lng!=""){
                $.ajax({
                    type: "GET",
                    url: "https://api.openweathermap.org/data/3.0/onecall?lat="+lat+"&lon="+lng+"&appid=b0fbe96cfe47ba62973a33ed3abfb1f1",
                    async: true,
                    success: function(r){
                        if(r["current"]["temp"]!="" && r["current"]["clouds"]!="" && r["timezone"]!="") {
                            $("#temp-level").html("<span id='searched-city-temp'><span id='changeable-temp'>"+r["current"]["temp"]+"</span><sup>o</sup>C</span>");
                            $("#cloudy-level").html("<span>"+r["current"]["clouds"]+"<sup>oktas</sup></span>");
                            $("#pressure-level").html("<span>"+r["current"]["pressure"]+"<sup>atm</sup></span>");
                            $("#humidity-level").html("<span>"+r["current"]["humidity"]+" g/m<sup>2</sup</span>");
                            $("#windy-level").html("<span>"+r["current"]["wind_deg"]+"<sup>km/h</sup</span>");
                            let cityNameArr = r["timezone"].split("/");
                            $(".city-to-save").html("Weather For: "+cityNameArr[1]);
                            $("#err-display").hide(200);
                            $("#current-city-temp-level").html("<span>"+r["current"]["temp"]+"<sup>o</sup>C</span>");
                            $("#current-city-cloudy-level").html("<span>"+r["current"]["clouds"]+"<sup>oktas</sup></span>");
                            $("#current-city-pressure-level").html("<span>"+r["current"]["pressure"]+"<sup>atm</sup></span>");
                            $("#current-city-humidity-level").html("<span>"+r["current"]["humidity"]+" g/m<sup>2</sup></span>");
                            $("#current-city-windy-level").html("<span>"+r["current"]["wind_deg"]+"<sup>km/h</sup></span>");
                            changeBGImage(r["current"]["weather"][0]["main"]);
                        } else $("#err-display").html("<div class='err-notice'>Failed to fetch weather updates, restart application.</div>");
                    }
                });  
            } else $("#err-display").html("<div class='err-notice'>Loading weather for your city, be patient...</div>");
        }
        currentCityWeather(coords);

        /****
         * 
         * * 
         * @Changes BANNER image to suit weather change
         * @Adaptive to updates made by the OpenWeather API
         * 
         * *  
         * 
         * */
        function changeBGImage(weatherCondition){  
            switch(weatherCondition){
                case "Clear":
                    $("#banner").css("background-image", 'url("./images/bg/a.jpg")');
                    break;

                case "Clouds":
                    $("#banner").css("background-image", 'url("./images/bg/b.jpg")');
                    break;

                case "Rain":
                    $("#banner").css("background-image", 'url("./images/bg/c.jpg")');
                    break;
                default:
                    $("#banner").css("background-image", 'url("./images/bg/a.jpg")');
                    break;
            }
        }

         /****
         * 
         * * 
         * @Five days weather Focus Update 
         * @Uses OpenWeatherMapAPI Call
         *  
         * *  
         * 
         * */
        function fiveDayWeatherForecast(coords){
            const lat = coords.lat;
            const lng = coords.lng;
            const current_city = coords.city;
            if(lat!="" && lng!=""){
                $.ajax({
                    type: "GET",
                    url: "https://api.openweathermap.org/data/3.0/onecall?lat="+lat+"&lon="+lng+"&appid=b0fbe96cfe47ba62973a33ed3abfb1f1",          
                    async: true,
                    success: function(r){
                        let focus = r.daily;
                        let fivedaysupdate = "";
                        for (const day in focus) {
                            var focusDate = new Date(focus[day]["dt"] * 1000).toLocaleDateString();
                            fivedaysupdate += '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 col-xl-4"><div class="site-box shadow"><i class="fa fa-paper"></i><h4 class="site-box-title">'+focusDate+'</h4><p class="sit-box-desc">'+focus[day]["summary"]+'</p></div></div>';
                        }$("#five-day-focus-wrapper").html(fivedaysupdate);
                    }
                });  
            } else $("#err-display").html("<div class='err-notice'>Loading five days weather forecast, you will be updated</div>");
        }

        
        /****
         * 
         * * 
         * @Receives city name from UI/UX
         * @Sends query to OpenWeatherMapAPI
         * @Next, updates UI/UX
         * 
         * *  
         * 
         * */
        $(function(){
            $("#search-btn").click(function(){
                const cityNameq = $("#search").val();
                if(cityNameq!=""){
                    $.ajax({
                        type: "GET",
                        url: "https://api.openweathermap.org/data/2.5/weather?q="+cityNameq+"&appid=b0fbe96cfe47ba62973a33ed3abfb1f1",
                        async: true,
                        success: function(r){
                            if(r["main"]["temp"]!="" && r["clouds"]["all"]!="" && r["timezone"]!="") {
                                $("#temp-level").html("<span id='searched-city-temp'><span class='changeable-temp'>"+r["main"]["temp"]+"</span><sup>o</sup>C</span>");
                                $("#cloudy-level").html("<span>"+r["clouds"]["all"]+"<sup>oktas</sup></span>");
                                $("#pressure-level").html("<span>"+r["main"]["pressure"]+"<sup>atm</sup></span>");
                                $("#humidity-level").html("<span>"+r["main"]["humidity"]+"g/m<sup>2</sup></span>");
                                $("#windy-level").html("<span>"+r["wind"]["deg"]+"<sup>km/h</sup></span>");
                                changeBGImage(r["weather"][0]["main"]);
                                let cityNameSearched = r["name"];
                                $(".city-to-save").html("Weather For: "+cityNameSearched);
                                $("#err-display").hide(200);
                            } else $("#err-display").html("<div class='err-notice'>Check city name, and restart the application.</div>");
                        },
                        error: function(err){
                            $("#err-display").html("<div class='err-notice-bad'>Network failure, restart application.</div>");      
                        } 
                    });   
                } else $("#err-display").html("<div clas='err-notice'>Enter City Name To Search</div>");
            });
        });

        /****
         * 
         * * 
         * @The following saves city weather into Local Storage 
         * @Uses Browser Default API
         * 
         * *  
         * 
         * */
        $(function(){
            $("#save-now").click(function(){
                alert();
                const townLabel = $("#city-to-save").val();
                const townTemperature = $("#searched-city-temp").val();
                if(isCityReady!=""){
                    if(typeof(Storage)){
                        localStorage.setItem("1", townLabel+" is "+townTemperature + "Celsius");
                    } else $("#err-display").html("<div class='err-notice'>This browser does not support local storage, update or use another browser like Operamini, Firefox or Google Chrome</div>");
                } else $("#err-display").html("<div class='err-notice'>You can only save a city after searching</div>");          
            });
        });
    
        
        /****
         * 
         * * 
         * @ets temperature records, converts to fahrenheit
         * @Next, updates temperature Display on the UI/UX
         * 
         * *  
         * 
         * */
        $(function(){
            $("#conver-units-btn").click(function(){
                let cityCurrTemp = $("#changeable-temp").text();
                if(cityCurrTemp!=""){
                    let f = (cityCurrTemp * (9/5)) + 32;
                    const fahrenheit = Math.round(f,2);
                    $("#temp-level").html("<span><span class='changeable-temp'>"+fahrenheit+"</span><sup>o</sup>F</span>");
                    $("#current-city-temp-level").html("<span><span class='changeable-temp'>"+fahrenheit+"</span><sup>o</sup>F</span>");
                    $("#err-display").html("<div class='err-notice'>Temperature Units Converted</div>");
                    $("#err-display").fadeOut(5000);
                } else $("#err-display").html("<div class='err-notice'>Can only convert if temperature is given</div>");  
                                   
            });
        });
       
    </script>
</body>
</html>